version: '3.4'

services:
  php:
    build:
      context: .
      target: php
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - SHOP_ID=${SHOP_ID}
      - SECRET_KEY=${SECRET_KEY}
      - PUBLIC_KEY=${PUBLIC_KEY}
      - ENVIRONMENT=${ENVIRONMENT}

  nginx:
    build:
      context: .
      target: nginx
    depends_on:
      - php
    ports:
      - "80:80"

  selenium:
    image: selenium/standalone-firefox:latest
    ports:
      - "4444:4444"
      - "7900:7900"
    shm_size: "2g"
    extra_hosts:
      - "host.docker.internal:host-gateway"

  phptools:
    build:
      context: .
      target: phptools
